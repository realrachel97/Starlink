{"ast":null,"code":"// https://github.com/scijs/integrate-adaptive-simpson\n// This algorithm adapted from pseudocode in:\n// http://www.math.utk.edu/~ccollins/refs/Handouts/rich.pdf\nfunction adsimp(f, a, b, fa, fm, fb, V0, tol, maxdepth, depth, state) {\n  if (state.nanEncountered) {\n    return NaN;\n  }\n\n  var h, f1, f2, sl, sr, s2, m, V1, V2, err;\n  h = b - a;\n  f1 = f(a + h * 0.25);\n  f2 = f(b - h * 0.25); // Simple check for NaN:\n\n  if (isNaN(f1)) {\n    state.nanEncountered = true;\n    return;\n  } // Simple check for NaN:\n\n\n  if (isNaN(f2)) {\n    state.nanEncountered = true;\n    return;\n  }\n\n  sl = h * (fa + 4 * f1 + fm) / 12;\n  sr = h * (fm + 4 * f2 + fb) / 12;\n  s2 = sl + sr;\n  err = (s2 - V0) / 15;\n\n  if (depth > maxdepth) {\n    state.maxDepthCount++;\n    return s2 + err;\n  } else if (Math.abs(err) < tol) {\n    return s2 + err;\n  } else {\n    m = a + h * 0.5;\n    V1 = adsimp(f, a, m, fa, f1, fm, sl, tol * 0.5, maxdepth, depth + 1, state);\n\n    if (isNaN(V1)) {\n      state.nanEncountered = true;\n      return NaN;\n    }\n\n    V2 = adsimp(f, m, b, fm, f2, fb, sr, tol * 0.5, maxdepth, depth + 1, state);\n\n    if (isNaN(V2)) {\n      state.nanEncountered = true;\n      return NaN;\n    }\n\n    return V1 + V2;\n  }\n}\n\nexport function integrate(f, a, b, tol, maxdepth) {\n  var state = {\n    maxDepthCount: 0,\n    nanEncountered: false\n  };\n\n  if (tol === undefined) {\n    tol = 1e-8;\n  }\n\n  if (maxdepth === undefined) {\n    maxdepth = 20;\n  }\n\n  var fa = f(a);\n  var fm = f(0.5 * (a + b));\n  var fb = f(b);\n  var V0 = (fa + 4 * fm + fb) * (b - a) / 6;\n  var result = adsimp(f, a, b, fa, fm, fb, V0, tol, maxdepth, 1, state);\n  /*\n    if (state.maxDepthCount > 0 && console && console.warn) {\n      console.warn('integrate-adaptive-simpson: Warning: maximum recursion depth (' + maxdepth + ') reached ' + state.maxDepthCount + ' times');\n    }\n  \n    if (state.nanEncountered && console && console.warn) {\n      console.warn('integrate-adaptive-simpson: Warning: NaN encountered. Halting early.');\n    }\n  */\n\n  return result;\n}","map":{"version":3,"names":["adsimp","f","a","b","fa","fm","fb","V0","tol","maxdepth","depth","state","nanEncountered","NaN","h","f1","f2","sl","sr","s2","m","V1","V2","err","isNaN","maxDepthCount","Math","abs","integrate","undefined","result"],"sources":["D:/LaiOfferProjects/starlink/starlink/node_modules/d3-geo-projection/src/integrate.js"],"sourcesContent":["// https://github.com/scijs/integrate-adaptive-simpson\n\n// This algorithm adapted from pseudocode in:\n// http://www.math.utk.edu/~ccollins/refs/Handouts/rich.pdf\nfunction adsimp (f, a, b, fa, fm, fb, V0, tol, maxdepth, depth, state) {\n  if (state.nanEncountered) {\n    return NaN;\n  }\n\n  var h, f1, f2, sl, sr, s2, m, V1, V2, err;\n\n  h = b - a;\n  f1 = f(a + h * 0.25);\n  f2 = f(b - h * 0.25);\n\n  // Simple check for NaN:\n  if (isNaN(f1)) {\n    state.nanEncountered = true;\n    return;\n  }\n\n  // Simple check for NaN:\n  if (isNaN(f2)) {\n    state.nanEncountered = true;\n    return;\n  }\n\n  sl = h * (fa + 4 * f1 + fm) / 12;\n  sr = h * (fm + 4 * f2 + fb) / 12;\n  s2 = sl + sr;\n  err = (s2 - V0) / 15;\n\n  if (depth > maxdepth) {\n    state.maxDepthCount++;\n    return s2 + err;\n  } else if (Math.abs(err) < tol) {\n    return s2 + err;\n  } else {\n    m = a + h * 0.5;\n\n    V1 = adsimp(f, a, m, fa, f1, fm, sl, tol * 0.5, maxdepth, depth + 1, state);\n\n    if (isNaN(V1)) {\n      state.nanEncountered = true;\n      return NaN;\n    }\n\n    V2 = adsimp(f, m, b, fm, f2, fb, sr, tol * 0.5, maxdepth, depth + 1, state);\n\n    if (isNaN(V2)) {\n      state.nanEncountered = true;\n      return NaN;\n    }\n\n    return V1 + V2;\n  }\n}\n\nexport function integrate (f, a, b, tol, maxdepth) {\n  var state = {\n    maxDepthCount: 0,\n    nanEncountered: false\n  };\n\n  if (tol === undefined) {\n    tol = 1e-8;\n  }\n  if (maxdepth === undefined) {\n    maxdepth = 20;\n  }\n\n  var fa = f(a);\n  var fm = f(0.5 * (a + b));\n  var fb = f(b);\n\n  var V0 = (fa + 4 * fm + fb) * (b - a) / 6;\n\n  var result = adsimp(f, a, b, fa, fm, fb, V0, tol, maxdepth, 1, state);\n\n/*\n  if (state.maxDepthCount > 0 && console && console.warn) {\n    console.warn('integrate-adaptive-simpson: Warning: maximum recursion depth (' + maxdepth + ') reached ' + state.maxDepthCount + ' times');\n  }\n\n  if (state.nanEncountered && console && console.warn) {\n    console.warn('integrate-adaptive-simpson: Warning: NaN encountered. Halting early.');\n  }\n*/\n\n  return result;\n}"],"mappings":"AAAA;AAEA;AACA;AACA,SAASA,MAAT,CAAiBC,CAAjB,EAAoBC,CAApB,EAAuBC,CAAvB,EAA0BC,EAA1B,EAA8BC,EAA9B,EAAkCC,EAAlC,EAAsCC,EAAtC,EAA0CC,GAA1C,EAA+CC,QAA/C,EAAyDC,KAAzD,EAAgEC,KAAhE,EAAuE;EACrE,IAAIA,KAAK,CAACC,cAAV,EAA0B;IACxB,OAAOC,GAAP;EACD;;EAED,IAAIC,CAAJ,EAAOC,EAAP,EAAWC,EAAX,EAAeC,EAAf,EAAmBC,EAAnB,EAAuBC,EAAvB,EAA2BC,CAA3B,EAA8BC,EAA9B,EAAkCC,EAAlC,EAAsCC,GAAtC;EAEAT,CAAC,GAAGX,CAAC,GAAGD,CAAR;EACAa,EAAE,GAAGd,CAAC,CAACC,CAAC,GAAGY,CAAC,GAAG,IAAT,CAAN;EACAE,EAAE,GAAGf,CAAC,CAACE,CAAC,GAAGW,CAAC,GAAG,IAAT,CAAN,CATqE,CAWrE;;EACA,IAAIU,KAAK,CAACT,EAAD,CAAT,EAAe;IACbJ,KAAK,CAACC,cAAN,GAAuB,IAAvB;IACA;EACD,CAfoE,CAiBrE;;;EACA,IAAIY,KAAK,CAACR,EAAD,CAAT,EAAe;IACbL,KAAK,CAACC,cAAN,GAAuB,IAAvB;IACA;EACD;;EAEDK,EAAE,GAAGH,CAAC,IAAIV,EAAE,GAAG,IAAIW,EAAT,GAAcV,EAAlB,CAAD,GAAyB,EAA9B;EACAa,EAAE,GAAGJ,CAAC,IAAIT,EAAE,GAAG,IAAIW,EAAT,GAAcV,EAAlB,CAAD,GAAyB,EAA9B;EACAa,EAAE,GAAGF,EAAE,GAAGC,EAAV;EACAK,GAAG,GAAG,CAACJ,EAAE,GAAGZ,EAAN,IAAY,EAAlB;;EAEA,IAAIG,KAAK,GAAGD,QAAZ,EAAsB;IACpBE,KAAK,CAACc,aAAN;IACA,OAAON,EAAE,GAAGI,GAAZ;EACD,CAHD,MAGO,IAAIG,IAAI,CAACC,GAAL,CAASJ,GAAT,IAAgBf,GAApB,EAAyB;IAC9B,OAAOW,EAAE,GAAGI,GAAZ;EACD,CAFM,MAEA;IACLH,CAAC,GAAGlB,CAAC,GAAGY,CAAC,GAAG,GAAZ;IAEAO,EAAE,GAAGrB,MAAM,CAACC,CAAD,EAAIC,CAAJ,EAAOkB,CAAP,EAAUhB,EAAV,EAAcW,EAAd,EAAkBV,EAAlB,EAAsBY,EAAtB,EAA0BT,GAAG,GAAG,GAAhC,EAAqCC,QAArC,EAA+CC,KAAK,GAAG,CAAvD,EAA0DC,KAA1D,CAAX;;IAEA,IAAIa,KAAK,CAACH,EAAD,CAAT,EAAe;MACbV,KAAK,CAACC,cAAN,GAAuB,IAAvB;MACA,OAAOC,GAAP;IACD;;IAEDS,EAAE,GAAGtB,MAAM,CAACC,CAAD,EAAImB,CAAJ,EAAOjB,CAAP,EAAUE,EAAV,EAAcW,EAAd,EAAkBV,EAAlB,EAAsBY,EAAtB,EAA0BV,GAAG,GAAG,GAAhC,EAAqCC,QAArC,EAA+CC,KAAK,GAAG,CAAvD,EAA0DC,KAA1D,CAAX;;IAEA,IAAIa,KAAK,CAACF,EAAD,CAAT,EAAe;MACbX,KAAK,CAACC,cAAN,GAAuB,IAAvB;MACA,OAAOC,GAAP;IACD;;IAED,OAAOQ,EAAE,GAAGC,EAAZ;EACD;AACF;;AAED,OAAO,SAASM,SAAT,CAAoB3B,CAApB,EAAuBC,CAAvB,EAA0BC,CAA1B,EAA6BK,GAA7B,EAAkCC,QAAlC,EAA4C;EACjD,IAAIE,KAAK,GAAG;IACVc,aAAa,EAAE,CADL;IAEVb,cAAc,EAAE;EAFN,CAAZ;;EAKA,IAAIJ,GAAG,KAAKqB,SAAZ,EAAuB;IACrBrB,GAAG,GAAG,IAAN;EACD;;EACD,IAAIC,QAAQ,KAAKoB,SAAjB,EAA4B;IAC1BpB,QAAQ,GAAG,EAAX;EACD;;EAED,IAAIL,EAAE,GAAGH,CAAC,CAACC,CAAD,CAAV;EACA,IAAIG,EAAE,GAAGJ,CAAC,CAAC,OAAOC,CAAC,GAAGC,CAAX,CAAD,CAAV;EACA,IAAIG,EAAE,GAAGL,CAAC,CAACE,CAAD,CAAV;EAEA,IAAII,EAAE,GAAG,CAACH,EAAE,GAAG,IAAIC,EAAT,GAAcC,EAAf,KAAsBH,CAAC,GAAGD,CAA1B,IAA+B,CAAxC;EAEA,IAAI4B,MAAM,GAAG9B,MAAM,CAACC,CAAD,EAAIC,CAAJ,EAAOC,CAAP,EAAUC,EAAV,EAAcC,EAAd,EAAkBC,EAAlB,EAAsBC,EAAtB,EAA0BC,GAA1B,EAA+BC,QAA/B,EAAyC,CAAzC,EAA4CE,KAA5C,CAAnB;EAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAEE,OAAOmB,MAAP;AACD"},"metadata":{},"sourceType":"module"}